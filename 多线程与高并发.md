# 多线程与高并发

### 1 .关键方法和关键字

###### 1.1 CAS

>CompareAndSwap无锁机制的比较交换。
>
>------------------
>
>原理：是读取内存中的值，然后根据该值去更新新值，最后写入内存，在写入内存之前，再次拿到内存中的值，看下该值是否被其他线程改变，如果被其他线程改变，则重新获取改变后的值，自己重新计算，再去尝试写入内存，直到内存中的值和自己拿到的值是一致的，才去写入内存。

> 存在的问题？
>
> -------
>
> 1、ABA问题
>
> 当线程拿到内存中数据为A，修改完值之后写入内存的时候，这时内存中的值被其他线程改了两次，由A改到B，再由B改到A，此时的A已经不是原始的A了，如果根据业务，必须需要知道是不是原来的A，就需要读取值的版本号，以此来解决ABA问题。
>
> 2、有没有可能两个线程同时写入内存，然后发生并发问题。
>
> 没有可能，因为CAS底层是汇编语言，最后的执行指令是 lock cmpxchg，最后的指令是机器加了锁的。
>
> 3、性能问题
>
> 如果该值频繁的被改，自己频繁的自旋比较，还是比较损耗新能的。

###### 1.2 Synchronized

